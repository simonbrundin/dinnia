import{n as d}from"./nhost.83afdd58.js";import{a as x,b as l,e as L,r as f,o as C,f as D,h as $,w as v,v as I,u as a,i as g,j as b,k as E,l as h,t as P,p as A,m as K}from"./entry.ae48a8f0.js";import{u as c}from"./auth.a9a63876.js";import{_ as R}from"./_plugin-vue_export-helper.c27b6911.js";x();const V=async(n,i)=>{const{error:e,session:r}=await d.auth.signUp({email:n,password:i});if(e)throw e;if(!r)throw l("/auth/verify"),"User needs to verify email";return l("/"),r},B=async(n,i)=>{console.log("Start signUp");try{await V(n,i);const e=c();e.signInErrorMessage="";return}catch(e){const r=c();r.signInErrorMessage=e.message}};x();const F=()=>d.auth.isAuthenticated(),W=async(n,i)=>{const{error:e,session:r}=await d.auth.signIn({email:n,password:i});if(e)throw e;if(!r)throw l("/auth/verify"),"User needs to verify email";return l("/"),r},M=async(n,i)=>{if(F())return l("/"),"Successful login";try{await B(n,i);return}catch{}if(i)try{await W(n,i);const e=c();e.signInErrorMessage="";return}catch(e){const r=c();r.signInErrorMessage=e.message}},N=""+new URL("google-logo.b0b9055a.png",import.meta.url).href,S=n=>(A("data-v-c4d3df29"),n=n(),K(),n),T={class:"flex flex-col gap-4"},j=S(()=>g("img",{src:N,class:"w-4",srcset:""},null,-1)),G=S(()=>g("div",null,"Fortsätt med Google",-1)),q=[j,G],z=L({__name:"login",setup(n){(async()=>{await(()=>d.auth.isAuthenticatedAsync())()&&l("/")})();const e=f(""),r=f(""),m=f(!1);f(!0);const w=f(!1),u=c(),_=async(o,s)=>{const{error:t,session:p}=await d.auth.signUp({email:o,password:s});if(t)throw t.status===409?(u.signInErrorMessage="",t):(u.signInErrorMessage=t.message,t);if(!p)throw l("/auth/verify"),u.signInErrorMessage="Du behöver verifiera din epostadress","Du behöver verifiera din epostadress";return l("/"),u.signInErrorMessage="",p},U=async(o,s)=>{const{error:t,session:p}=await d.auth.signIn({email:o,password:s});if(t)throw t.status===401&&(m.value=!0,w.value=!0),u.signInErrorMessage=t.message,t;if(!p)throw l("/auth/verify"),u.signInErrorMessage="Du behöver verifiera din epostadress","Du behöver verifiera din epostadress";return l("/"),u.signInErrorMessage="",p},y=()=>{if(!r.value){m.value=!0;return}try{_(e.value,r.value),U(e.value,r.value)}catch{}},k=async()=>{const{error:o}=await d.auth.resetPassword({email:e.value});if(o)throw u.signInErrorMessage=o.message,o;u.signInErrorMessage="Kolla din epost för att återställa lösenordet"};return(o,s)=>(C(),D("div",T,[$("",!0),v(g("input",{type:"email",name:"email","onUpdate:modelValue":s[0]||(s[0]=t=>b(e)?e.value=t:null),onKeyup:s[1]||(s[1]=E(t=>y(),["enter"])),autofocus:"",placeholder:"Epostadress",class:"px-4 py-4 rounded-lg text-gray-700"},null,544),[[I,a(e)]]),v(g("input",{type:"password",name:"password","onUpdate:modelValue":s[2]||(s[2]=t=>b(r)?r.value=t:null),onKeyup:s[3]||(s[3]=E(t=>y(),["enter"])),autofocus:"",placeholder:"Lösenord",class:"px-4 py-4 rounded-lg text-gray-700"},null,544),[[h,a(m)],[I,a(r)]]),g("button",{onClick:s[4]||(s[4]=t=>y()),class:"bg-blue-500 px-4 py-4 rounded-lg text-slate-50"}," Fortsätt "),v(g("button",{onClick:s[5]||(s[5]=t=>("signIn"in o?o.signIn:a(M))(a(e))),class:"bg-slate-700 px-4 py-4 rounded-lg text-slate-50"}," Fortsätt med Passkey ",512),[[h,!1]]),v(g("div",{class:"text-slate-700 bg-red-200 border-red-300 border-4 p-4 rounded-lg"},P(a(c)().signInErrorMessage),513),[[h,a(c)().signInErrorMessage]]),v(g("div",{onClick:s[6]||(s[6]=t=>k()),class:"text-white"}," Återställ lösenord ",512),[[h,a(w)]]),g("button",{onClick:s[7]||(s[7]=t=>("signIn"in o?o.signIn:a(M))(a(e),a(r))),class:"bg-slate-700 px-4 py-4 rounded-lg text-slate-50 grid google-button items-center"},q)]))}});const X=R(z,[["__scopeId","data-v-c4d3df29"]]);export{X as default};
